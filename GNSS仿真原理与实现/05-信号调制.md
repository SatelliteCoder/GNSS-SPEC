# <div style="text-align: center;">📶 🤖 GNSS 信号调制技术原理、公式与实现</div>

<p align="center"> 
    <img src="https://img.shields.io/badge/领域-GNSS%20物理层-blue.svg" alt="Field"/> 
    <img src="https://img.shields.io/badge/内容-信号调制|扩频|多路复用-yellowgreen.svg" alt="Topic"/> 
    <img src="https://img.shields.io/badge/系统-GPS|Galileo|BDS|GLONASS-orange.svg" alt="Systems"/> 
    <img src="https://img.shields.io/badge/难度-进阶-red.svg" alt="Difficulty"/> 
</p>

## 📖 目录

- [📖 目录](#-目录)
- [🎯 概述](#-概述)
- [1. GNSS 信号组成](#1-gnss-信号组成)
- [2. 核心调制技术](#2-核心调制技术)
  - [2.1 二进制相移键控 (BPSK)](#21-二进制相移键控-bpsk)
  - [2.2 二进制偏移载波 (BOC)](#22-二进制偏移载波-boc)
  - [2.3 正交复用 (QPSK, AltBOC)](#23-正交复用-qpsk-altboc)
- [3. 各系统信号调制详解](#3-各系统信号调制详解)
  - [3.1 GPS (美国)](#31-gps-美国)
  - [3.2 Galileo (欧盟)](#32-galileo-欧盟)
  - [3.3 BDS-3 (中国)](#33-bds-3-中国)
  - [3.4 GLONASS (俄罗斯)](#34-glonass-俄罗斯)
- [4. 实现与仿真](#4-实现与仿真)
- [⚠️ 注意事项](#️-注意事项)
- [📚 参考文献](#-参考文献)

---

## 🎯 概述

全球导航卫星系统（GNSS）信号是经过精密设计的**伪随机码扩频信号**。其调制方式的选择直接决定了信号的**抗干扰能力**、**多径分辨力**、**码跟踪精度**以及与其它系统的**频谱兼容性**。本指南将深入解析主流GNSS信号的调制方案、数学表达及其仿真实现方法。

---

## 1. GNSS 信号组成

一个基本的GNSS信号基带数学模型可以表示为：

$$
s(t) = A \cdot D(t) \cdot C(t) \cdot S(t)
$$

其中：
- $A$：信号振幅
- $D(t)$：导航电文数据码（取值为 ±1）
- $C(t)$：伪随机噪声码（PRN Code，取值为 ±1）
- $S(t)$：子载波（Subcarrier，对于BPSK，$S(t) = 1$；对于BOC，$S(t)$为方波）

该基带信号最终被调制到射频载波 $f_c$ 上：
$$
s_{RF}(t) = s_I(t) \cdot \cos(2\pi f_c t) - s_Q(t) \cdot \sin(2\pi f_c t)
$$
其中 $s_I(t)$ 和 $s_Q(t)$ 分别是同相和正交支路的基带信号。

---

## 2. 核心调制技术

### 2.1 二进制相移键控 (BPSK)

**BPSK(𝑛)** 是最简单的调制方式，其中 `n` 表示码片速率（单位：Mcps）。其子载波 $S(t)=1$。

- **实现公式**：
  $$
  s_{BPSK}(t) = A \cdot D(t) \cdot C(t)
  $$
- **功率谱密度（PSD）主瓣宽度**：$2 \times n$ MHz
- **特点**：实现简单，抗噪性能好，但频谱效率相对较低。
- **应用**：GPS L1 C/A, BDS B1I 等。

### 2.2 二进制偏移载波 (BOC)

**BOC(𝑚, 𝑛)** 通过一个频率为 $f_s = m \times 1.023$ MHz 的方波子载波对PRN码进行二次调制。`m` 是子载波频率系数，`n` 是码速率系数。

- **实现公式**：
  $$
  s_{BOC}(t) = A \cdot D(t) \cdot C(t) \cdot \sign(\sin(2\pi f_s t))
  $$
- **功率谱密度（PSD）**：分裂为主瓣和边瓣，中心与载波频率有 $f_s$ 的偏移。
- **特点**：
  - **优点**：更高的码跟踪精度和更好的多径抑制能力（因其更尖锐的相关峰）。
  - **缺点**：可能存在模糊问题，需要复杂的跟踪技术（如双估计器）。
- **变体**：
  - **SinBOC / CosBOC**：使用正弦或余弦相位方波。
  - **MBOC**：BOC(1,1) 和 BOC(6,1) 的复合，如 GPS L1C 和 Galileo E1 OS。
- **应用**：GPS M-code, Galileo E1 OS, BDS B1C/B2a。

### 2.3 正交复用 (QPSK, AltBOC)

用于在一个载波上高效复用两个或多个信号分量。

- **QPSK**：传统的正交相移键控，I、Q两支路分别调制不同的信号。
  $$
  s_{QPSK}(t) = s_I(t)\cdot\cos(2\pi f_c t) - s_Q(t)\cdot\sin(2\pi f_c t)
  $$

- **AltBOC（交替二进制偏移载波）**：一种高级的恒包络调制技术，可将4个信号分量复用到单个载波上，同时保持BOC-like的优越性能。
  - **实现**：非常复杂，涉及对两个边带信号进行联合调制。
  - **特点**：极高的频谱效率和性能，实现复杂度高。
  - **应用**：**Galileo E5** 和 **E6** 信号。

---

## 3. 各系统信号调制详解

### 3.1 GPS (美国)

| 频点 | 信号 | 调制方式 | 码速率 | 数据速率 | 特点与应用 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **L1 (1575.42 MHz)** | C/A | BPSK(1) | 1.023 Mcps | 50 bps | 民用标准，全球开放 |
| | P(Y) | BPSK(10) | 10.23 Mcps | 50 bps | 军用加密，抗干扰强 |
| | M | BOC(10,5) | 5.115 Mcps | 未知 | 军用，高安全抗干扰 |
| | L1C | TMBOC(6,1,4/33) | 1.023 Mcps | 100/200 bps (F/NAV) | 现代化民用信号，与Galileo互操作 |
| **L2 (1227.60 MHz)** | L2C | BPSK(1) (CM&CL) | 1.023 Mcps / 511.5 kcps | 25/50 bps | 民用，增强双频定位 |
| | L5 (1176.45 MHz) | QPSK(10) | 10.23 Mcps | 50/100 bps | 航空安全生命线，高性能民用 |

*TMBOC: Time-Multiplexed BOC，在数据通道使用BOC(1,1)，在导频通道使用BOC(6,1)。*

### 3.2 Galileo (欧盟)

| 频点 | 信号 | 调制方式 | 码速率 | 数据速率 | 特点与应用 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **E1 (1575.42 MHz)** | OS (Open Service) | CBOC(6,1,1/11) | 1.023 Mcps | 125 bps (F/NAV) | 与GPS L1C互操作，数据+导频 |
| **E5 (1191.795 MHz)** | E5a&b | AltBOC(15,10) | 10.23 Mcps | 50 bps (I/NAV) | 超宽频带，极高测距精度 |
| **E6 (1278.75 MHz)** | CS (Commercial) | BPSK(5) | 5.115 Mcps | 未知 | 高精度商业加密服务 |

*CBOC: Composite BOC，BOC(1,1)和BOC(6,1)的线性组合。*

### 3.3 BDS-3 (中国)

| 频点 | 信号 | 调制方式 | 码速率 | 数据速率 | 特点与应用 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **B1I (1561.098 MHz)** | B1I | BPSK(2) | 2.046 Mcps | 50 bps | 向后兼容BDS-2 |
| **B1C (1575.42 MHz)** | B1C | QMBOC(6,1,4/33) | 1.023 Mcps | 100/200 bps | 与GPS L1C/Galileo E1互操作 |
| **B2a (1176.45 MHz)** | B2a | BPSK(10) | 10.23 Mcps | 50/200 bps | 与GPS L5/Galileo E5a互操作 |
| **B3I (1268.52 MHz)** | B3I | BPSK(10) | 10.23 Mcps | 500 bps | 授权服务，高安全性 |

*QMBOC: Quadrature Multiplexed BOC，类似于TMBOC。*

### 3.4 GLONASS (俄罗斯)

| 频点 | 信号 | 调制方式 | 特点 |
| :--- | :--- | :--- | :--- |
| **L1 (1602+𝑘×0.5625 MHz)** | SP | BPSK(0.511) | 码速低，抗干扰能力较弱 |
| **L2 (1246+𝑘×0.4375 MHz)** | SP | BPSK(0.511) | |
| **L3 (1202.025 MHz)** | CDMA | BOC(1,1) | 现代化信号，向CDMA体制过渡 |
| **L1OC, L2OC** | CDMA | BPSK(5.115) | 新的开放CDMA信号 |

*GLONASS采用FDMA（频分多址），每个卫星使用略微不同的频率（k为频道号）。其现代化信号L3、L1OC、L2OC已采用CDMA（码分多址）体制。*

---

## 4. 实现与仿真

以下是使用 Python 进行 BPSK 和 BOC 调制基带信号生成的简化代码示例。

```python
import numpy as np
import matplotlib.pyplot as plt

def generate_prn_code(prn, code_length, code_type='GPS_L1CA'):
    """
    生成PRN码序列（简化版，实际中需根据ICD定义生成）
    """
    # 此处应为根据PRN号和码型初始化移位寄存器并生成码片的复杂逻辑
    # 返回一个由 +1 和 -1 组成的数组，长度为 code_length
    return np.random.choice([-1, 1], size=code_length) # 用随机码代替

def generate_bpsk_signal(data_bits, prn_code, samples_per_chip):
    """
    生成BPSK调制信号
    Args:
        data_bits: 导航电文数据位数组 (值为 ±1)
        prn_code: PRN码序列 (值为 ±1)
        samples_per_chip: 每个码片的采样点数
    Returns:
        s_bpsk: BPSK基带信号
        t: 时间轴
    """
    # 将每个数据位与整个PRN码序列相乘（扩频）
    spread_symbols = np.outer(data_bits, prn_code).flatten()
    # 对扩频后的序列进行上采样
    s_bpsk = np.repeat(spread_symbols, samples_per_chip)
    t = np.arange(len(s_bpsk)) / (samples_per_chip * len(prn_code) * 50) # 假设数据速率50bps
    return s_bpsk, t

def generate_boc_signal(data_bits, prn_code, samples_per_chip, m, n):
    """
    生成BOC调制信号
    Args:
        m, n: BOC(m, n)参数
    """
    # 1. 生成扩频序列（同BPSK）
    spread_symbols = np.outer(data_bits, prn_code).flatten()
    
    # 2. 生成BOC子载波
    f_s = m * 1.023e6  # 子载波频率
    chip_rate = n * 1.023e6
    samples_per_subchip = int(samples_per_chip * (chip_rate / f_s) / 2) # 每个半子载波周期的采样点数
    # 生成一个周期的方波子载波：[+1, +1, ..., -1, -1, ...]
    one_subcarrier_period = np.concatenate([
        np.ones(samples_per_subchip),
        -1 * np.ones(samples_per_subchip)
    ])
    # 将子载波周期重复到与扩频序列长度匹配
    num_repeats = int(len(spread_symbols) * samples_per_chip / len(one_subcarrier_period)) + 1
    subcarrier_wave = np.tile(one_subcarrier_period, num_repeats)
    subcarrier_wave = subcarrier_wave[:len(spread_symbols) * samples_per_chip]
    
    # 3. 将扩频序列上采样，然后与子载波相乘
    spread_symbols_upsampled = np.repeat(spread_symbols, samples_per_chip)
    s_boc = spread_symbols_upsampled * subcarrier_wave
    
    t = np.arange(len(s_boc)) / (samples_per_chip * chip_rate)
    return s_boc, t

# --- 参数设置 ---
prn_code_length = 1023  # GPS C/A码长度
samples_per_chip = 10   # 每个码片的采样点数
data_bits = np.array([1, -1, 1, 1, -1]) # 示例数据位

# 生成PRN码（示例）
prn_code = generate_prn_code(prn=1, code_length=prn_code_length)

# --- 生成信号 ---
s_bpsk, t_bpsk = generate_bpsk_signal(data_bits, prn_code, samples_per_chip)
s_boc, t_boc = generate_boc_signal(data_bits, prn_code, samples_per_chip, m=1, n=1)

# --- 绘制时域波形（一小段） ---
fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(12, 6))
ax1.plot(t_bpsk[:1000], s_bpsk[:1000])
ax1.set_title('BPSK(1) Signal Waveform')
ax1.set_xlabel('Time (s)')
ax1.set_ylabel('Amplitude')

ax2.plot(t_boc[:1000], s_boc[:1000])
ax2.set_title('BOC(1,1) Signal Waveform')
ax2.set_xlabel('Time (s)')
ax2.set_ylabel('Amplitude')

plt.tight_layout()
plt.show()

# --- 绘制功率谱密度（PSD）---
from scipy import signal
f_bpsk, Pxx_bpsk = signal.welch(s_bpsk, fs=1.023e6*samples_per_chip, nperseg=1024)
f_boc, Pxx_boc = signal.welch(s_boc, fs=1.023e6*samples_per_chip, nperseg=1024)

plt.figure(figsize=(10, 5))
plt.semilogy(f_bpsk/1e6, Pxx_bpsk, label='BPSK(1)')
plt.semilogy(f_boc/1e6, Pxx_boc, label='BOC(1,1)')
plt.xlabel('Frequency [MHz]')
plt.ylabel('PSD [V**2/Hz]')
plt.title('Power Spectral Density Comparison')
plt.legend()
plt.grid(True)
plt.xlim(0, 20) # 只看前20MHz
plt.show()
```

---

## ⚠️ 注意事项

1.  **规范性文件**：实际实现必须严格遵循各系统的**接口控制文件（ICD）**，其中明确定义了码生成多项式、调制细节和电文格式。
2.  **性能权衡**：BOC调制提供了更好的性能，但也带来了**模糊性**，接收机需要更复杂的算法（如`Bump-Jump`、`Double Estimator`）来锁定主峰。
3.  **互相关特性**：不同的PRN码设计旨在减少卫星信号间的互干扰，仿真中需使用正确的码生成器。
4.  **恒包络**：星上发射机功放通常工作在饱和区，因此最终发射的信号必须是**恒包络**的。AltBOC、CASM等多路复用技术就是为了在复用多个信号时保持恒包络。
5.  **带宽限制**：仿真和实际系统中，信号在发射前都会经过**带宽限制滤波**，以符合频谱掩膜要求，这会影响相关函数的形状。

---

## 📚 参考文献

1.  **GPS IS-GPS-200**: Navstar GPS Space Segment/Navigation User Segment Interfaces.
2.  **Galileo OS ICD**: European GNSS (Galileo) Open Service Signal-In-Space Interface Control Document.
3.  **BDS OS ICD**: BeiDou Navigation Satellite System Signal In Space Interface Control Document.
4.  **GLONASS ICD**: GLONASS Interface Control Document.
5.  **Betz, J. W. (2016). *Engineering Satellite-Based Navigation and Timing: Global Navigation Satellite Systems, Signals, and Receivers.* IEEE Press, John Wiley & Sons.** (经典权威教材)
6.  **Kaplan, E. D., & Hegarty, C. J. (2017). *Understanding GPS/GNSS: Principles and Applications.* Artech House.** (入门与实践宝典)

<p align="center">
  <sub>构建于 📡 之上，为 GNSS 社区赋能</sub>
</p>
---
