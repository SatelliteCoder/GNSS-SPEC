概述
GNSS信号仿真（GNSS Signal Simulation）是指通过软件或硬件手段，模拟生成真实的全球导航卫星系统（如GPS、北斗、GLONASS、Galileo）卫星信号的过程。其核心目标是**在受控的实验室环境中，复现真实世界中复杂多变的卫星信号环境**，从而用于测试、验证、校准和研发。

一、原理
GNSS信号仿真的基本原理可以概括为：**根据用户设定的场景（包括时间、地点、运动轨迹、环境等），计算出每一颗可见卫星的信号到达接收机天线端的精确状态，然后利用数学模型生成对应的数字中频（IF）或射频（RF）信号。**

技术实现主要包含以下几个核心模块：

1. 场景与轨迹生成 (Scenario & Trajectory Generation)
这是仿真的输入。用户需要定义：
*   接收机动态：静态、匀速、加速、高动态（如导弹、战斗机）、特定轨迹（如绕圈、8字形）。
*   地理位置和时间：初始经纬高、日期和时间（用于计算卫星位置）。
*   环境条件：大气模型（电离层、对流层延迟）、多路径效应（反射信号）、遮挡物（城市峡谷、树木）、干扰和欺骗信号。

2. 卫星星座计算 (Satellite Constellation Computation)
根据输入的日期和时间，仿真器利用**精密星历**或**广播星历**数据，计算出仿真时刻天空中每一颗GNSS卫星在WGS-84坐标系中的精确位置和速度。

3. 几何距离与误差计算 (Geometry and Error Calculation)
这是仿真的核心计算部分。
*   几何距离：计算每颗卫星到接收机（根据轨迹）的瞬时几何距离。
*   卫星钟差：根据导航电文中的钟差参数模型计算并修正每颗卫星的时钟误差。
*   相对论效应：修正由于卫星高速运动和地球引力场造成的频率与时间偏移。
*   大气延迟：
    *   电离层延迟：使用Klobuchar等模型（对于单频接收机）或双频无电离层组合来模拟。
    *   对流层延迟：使用Hopfield、Saastamoinen等模型模拟。
*   地球自转效应（Sagnac效应）：在信号传播时间内，地球发生了旋转，需要修正坐标系。

4. 信号生成 (Signal Generation)
根据上述计算出的所有参数，生成最终的信号。
*   载波生成：生成L1、L2、B1、B1C等频点的载波信号。其相位中包含了由多普勒频移（由卫星与接收机的相对运动引起）和**钟差**导致的频率变化。`相位 = 2 * π * (中频频率 + 多普勒频率) * 时间`
*   测距码生成：生成C/A码、P码、B1I、B2I等伪随机噪声码。其码相位会根据计算出的伪距进行精确控制。`伪距 = 几何距离 + 钟差 + 大气延迟 + 其他误差`
*   导航电文调制：将计算好的导航电文比特（包含星历、历书、时间等信息）调制到测距码上。
*   合成与输出：将带有导航电文的测距码调制到载波上，并加上设定的噪声、多路径信号和干扰信号，最终输出为数字中频信号（交由后续的ADC和RF模块处理）或直接上变频为射频信号。
